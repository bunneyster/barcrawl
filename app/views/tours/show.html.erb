<p id="notice"><%= notice %></p>

<p>
  <strong>Name:</strong>
  <%= @tour.name %>
</p>

<p>
  <strong>Organizer:</strong>
  <%= image_tag avatar_url(@tour.organizer) %>
  <%= @tour.organizer.name %>
</p>

<p>
  <strong>Day & Starting time:</strong>
  <%= @tour.starting_at %>
</p>

<p>
  <strong>Image:</strong>
  <%= @tour.image %>
</p>

<p>
  <strong>Description:</strong>
  <%= @tour.description %>
</p>


<%= link_to 'Edit', edit_tour_path(@tour) %> |
<%= link_to 'Home', root_path %> |
<%= link_to "Log out", root_url, method: :delete %>

<%= render partial: "rsvp_button" %>


<p>People attending:</p>
<ol>
  <% Invitation.where(tour_id: @tour.id).each do |invitation| %>
  <li><%= image_tag avatar_url(invitation.user) %><%= invitation.user.name %></li>
  <% end %>
</ol>

<%= hidden_div_if(@current_user != @tour.organizer) do %>
  <%= @tour.status %>
<% end %>

<p>Proposed venues:</p>
<ol>
  <%= render partial: "voting_line_item", collection: @tour.tour_stops, as: :tour_stop %>
</ol>

<!-- User can only propose tour stops for a pending tour if she has an invitation to the event. -->
<%= hidden_div_if(!((@tour.status === "pending") && (@tour.users.where(id: @current_user.id).exists?))) do %>
  <%= link_to 'Propose a tour stop', new_tour_stop_path(tour_id: @tour.to_param) %>
<% end %>

<%= hidden_div_if(@current_user != @tour.organizer || @tour.status === "finalized") do %>
  <%= form_for @tour do |f| %>
    <%= f.hidden_field :status, value: 'finalized' %>
    <%= f.submit "Finalize itinerary" %>
  <% end %>
<% end %>
